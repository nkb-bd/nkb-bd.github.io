import{a as l,i as ae,p as W,b,h as d,c as u,m as S,d as C,s as x,e as We,f as $e,o as p,_ as y,g as je,j as Le,k as Ne,l as He,n as Ue,q as Be,r as Ve,t as De,u as ze,v as Ke,w as Ge,x as R,y as Ye,z as Je,A as V,B as qe,C as le,D as Me,E as Qe,F as ue,G as Xe,H as ce,I as Ze,J as fe,K as et,L as tt}from"./chunk-2f012569.js";function P(e){return typeof e!="object"||e===null?!1:Object.getPrototypeOf(e)===null?!0:e.constructor.name==="Object"}function M(e){return"["+e.map(t=>"'"+t+"'").join(", ")+"]"}function D(e){var t,n;"urlPathname"in e?(l(((t=Object.getOwnPropertyDescriptor(e,"urlPathname"))===null||t===void 0?void 0:t.get)===Q),l(((n=Object.getOwnPropertyDescriptor(e,"urlParsed"))===null||n===void 0?void 0:n.get)===X)):(Object.defineProperty(e,"urlPathname",{get:Q,enumerable:!0,configurable:!0}),Object.defineProperty(e,"urlParsed",{get:X,enumerable:!0,configurable:!0}))}function de(e){let{url:t,_baseUrl:n,_urlProcessor:i}=e;return l(n.startsWith("/")),l(i===null||ae(i)),i!==null&&(t=i(t)),W(t,n)}function Q(){const{pathname:e}=de(this),t=e;return l(t.startsWith("/")),t}function X(){const e=de(this),{origin:t,pathname:n,pathnameOriginal:i,search:r,searchAll:o,searchOriginal:s,hash:a,hashOriginal:c}=e,f={origin:t,pathname:n,pathnameOriginal:i,search:r,searchAll:o,searchOriginal:s,hash:a,hashOriginal:c,get hashString(){return b(!1,"`pageContext.urlParsed.hashString` has been renamed to `pageContext.urlParsed.hashOriginal`",{onlyOnce:!0,showStackTrace:!0}),c},get searchString(){return b(!1,"`pageContext.urlParsed.searchString` has been renamed to `pageContext.urlParsed.searchOriginal`",{onlyOnce:!0,showStackTrace:!0}),s}};return Z(f,"hashString"),Z(f,"searchString"),f}function Z(e,t){const n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(e,t,{...n,enumerable:!1})}function nt(e,t){if(!P(e))return!1;for(const n of Object.keys(e))if(!t.includes(n))return!1;return!0}function rt(e){return d(e,"then")&&ae(e.then)}const z="@",U=":";function K(e,t){u(e==="*"||e.startsWith("/"),`Invalid route string \`${e}\`${e===""?" (empty string)":""}: route strings should start with a leading slash \`/\` (or be \`*\`).`),l(t.startsWith("/"));const n=e.split("/"),i=t.split("/"),r={};st(e),e==="*"&&(e="/*");for(let o=0;o<Math.max(n.length,i.length);o++){const s=n[o],a=i[o];if(s==="*")return r["*"]=i.slice(Math.max(1,o)).join("/"),{routeParams:r};if(s&&I(s)){if(b(!s.startsWith(U),`Outdated route string \`${e}\`, use \`${e.split(U).join(z)}\` instead.`,{onlyOnce:!0}),!a)return null;r[s.slice(1)]=a}else if((s||"")!==(a||""))return null}return{routeParams:r}}function st(e){const t=e.split("*").length-1;u(t<=1,`Invalid route string \`${e}\`: route strings are not allowed to contain more than one glob character \`*\`.`),u(t===0||t===1&&e.endsWith("*"),`Invalid route string \`${e}\`: make sure your route string ends with the glob character \`*\`.`)}function F(e){const t=e.split("/").filter(s=>s!==""&&s!=="*");let n=0;for(const s of t){if(I(s))break;n++}const i=t.filter(s=>!I(s)).length,r=t.filter(s=>I(s)).length,o=e.endsWith("*");return{numberOfParameterSegments:r,numberOfStaticSegmentsBeginning:n,numberOfStaticSegements:i,isCatchAll:o}}function I(e){return e.startsWith(z)||e.startsWith(U)}function ee(e){const n=K(e,e);return n!==null&&Object.keys(n.routeParams).length===0}function ot(e){e.sort(it).sort(S(t=>t.routeType==="FUNCTION"&&!!t.precedence&&t.precedence<0)).sort(S(t=>t.routeType==="STRING"&&ee(t.routeString)===!1)).sort(S(t=>t.routeType==="FUNCTION"&&!t.precedence)).sort(S(t=>t.routeType==="STRING"&&ee(t.routeString)===!0)).sort(S(t=>t.routeType==="FILESYSTEM")).sort(S(t=>t.routeType==="FUNCTION"&&!!t.precedence&&t.precedence>0))}function it(e,t){var n,i;{const r=(n=e.precedence)!==null&&n!==void 0?n:0,o=(i=t.precedence)!==null&&i!==void 0?i:0;if(r!==o)return r>o?-1:1}if(!t.routeString||!e.routeString)return 0;{const o=C(s=>F(s).numberOfStaticSegmentsBeginning)(e.routeString,t.routeString);if(o!==0)return o}{const o=C(s=>F(s).numberOfStaticSegements)(e.routeString,t.routeString);if(o!==0)return o}{const o=C(s=>F(s).numberOfParameterSegments)(e.routeString,t.routeString);if(o!==0)return o}{if(F(t.routeString).isCatchAll)return-1;if(F(e.routeString).isCatchAll)return 1}return 0}function at(e,t){return ft(e)?K(e,t):lt(e,t)}function lt(e,t){return t=ut(t),l(t.startsWith("/")),l(e.startsWith("/")),l(!t.endsWith("/")||t==="/"),l(!e.endsWith("/")||e==="/"),t!==e?null:{routeParams:{}}}function ut(e){if(!e.endsWith("/"))return e;for(;e.endsWith("/");)e=x(e,0,-1);return e===""?"/":e}function ct(e,t){const i=t.filter(({filesystemRoot:o})=>e.startsWith(o)).sort(C(({filesystemRoot:o})=>o.length))[0];let r;if(i){const{filesystemRoot:o,routeRoot:s}=i,a={pageId:e,filesystemRoot:o,routeRoot:s};l(s.startsWith("/")&&e.startsWith("/")&&o.startsWith("/"),a),l(e.startsWith(o),a),o!=="/"?(l(!o.endsWith("/"),a),r=x(e,o.length,0)):r=e,l(r.startsWith("/"),a),r=s+(s.endsWith("/")?"":"/")+x(r,1,0)}else r=e;return l(r.startsWith("/")),r=r.split("/").filter(o=>o!=="pages"&&o!=="src"&&o!=="index").join("/"),l(!r.includes(".page.")),l(!r.endsWith(".")),r.endsWith("/index")&&(r=x(r,0,-6)),r===""&&(r="/"),l(r.startsWith("/")),l(!r.endsWith("/")||r==="/"),r}function ft(e){return e.includes(z)}async function dt(e,t,n,i){const r=i,o="route()";let s;try{s=e.default({url:t,pageContext:n})}catch(f){return{hookError:f,hookName:o,hookFilePath:r}}u(!rt(s)||e.iKnowThePerformanceRisksOfAsyncRouteFunctions,`The Route Function ${i} returned a promise; async route functions are opt-in, see https://vite-plugin-ssr.com/route-function#async`);try{s=await s}catch(f){return{hookError:f,hookName:o,hookFilePath:r}}if(s===!1)return null;s===!0&&(s={}),u(P(s),`The Route Function ${i} should return a boolean or a plain JavaScript object, instead it returns \`${d(s,"constructor")?s.constructor:s}\`.`);let a=null;d(s,"precedence")&&(a=s.precedence,u(typeof a=="number",`The \`precedence\` value returned by the Route Function ${i} should be a number.`)),u(!("pageContext"in s),"Providing `pageContext` in Route Functions is forbidden, see https://vite-plugin-ssr.com/route-function#async"),ge(s,`The \`routeParams\` object returned by the Route Function ${i} should`);const c=s.routeParams||{};return l(P(c)),Object.keys(s).forEach(f=>{u(f==="match"||f==="routeParams"||f==="precedence",`The Route Function ${i} returned an object with an unknown key \`{ ${f} }\`. Allowed keys: ['match', 'routeParams', 'precedence'].`)}),{precedence:a,routeParams:c}}function ge(e,t){l(t.endsWith(" should")),d(e,"routeParams")&&(u(P(e.routeParams),`${t} be a plain JavaScript object.`),u(Object.values(e.routeParams).every(n=>typeof n=="string"),`${t} only hold string values.`))}function pe(e,{hook:t,errorMessagePrefix:n}){if(!n){l(t);const{hookName:i,hookFilePath:r}=t;l(r.startsWith("/")),l(!i.endsWith(")")),n=`The \`pageContext\` provided by the \`export { ${i} }\` of ${r}`}u(We(e),`${n} should be an object.`),u(!("_objectCreatedByVitePluginSsr"in e),`${n} should not be the whole \`pageContext\` object, see https://vite-plugin-ssr.com/pageContext-manipulation#do-not-return-entire-pagecontext`),b(!("_pageId"in e),"You are using `onBeforeRoute()` to override vite-plugin-ssr routing. This is experimental: make sure to contact a vite-plugin-ssr maintainer before using this.",{onlyOnce:!0})}async function gt(e,t){const n=e.filePath,i="onBeforeRoute";let r;try{r=await e.onBeforeRoute(t)}catch(a){return{hookError:a,hookName:i,hookFilePath:n}}const o=`The \`onBeforeRoute()\` hook exported by ${e.filePath}`;if(u(r==null||nt(r,["pageContext"])&&d(r,"pageContext"),`${o} should return \`null\`, \`undefined\`, or a plain JavaScript object \`{ pageContext: { /* ... */ } }\`.`),r==null)return{};if(u(d(r,"pageContext","object"),`${o} returned \`{ pageContext }\` but \`pageContext\` should be a plain JavaScript object.`),d(r.pageContext,"_pageId")&&!d(r.pageContext,"_pageId","null")){const a=`${o} returned \`{ pageContext: { _pageId } }\` but \`_pageId\` should be`;u(d(r.pageContext,"_pageId","string"),`${a} a string or \`null\``),u(t._allPageIds.includes(r.pageContext._pageId),`${a} one of following values: \`[${t._allPageIds.map(c=>`'${c}'`).join(", ")}]\`.`)}d(r.pageContext,"routeParams")&&ge(r.pageContext,`${o} returned \`{ pageContext: { routeParams } }\` but \`routeParams\` should`);const s=r.pageContext;return pe(s,{hook:{hookFilePath:n,hookName:i}}),{pageContextProvidedByUser:s}}async function pt(e){let t=null;const n=[];await Promise.all(e._pageFilesAll.filter(s=>s.fileType===".page.route").map(s=>{var a;return(a=s.loadFile)===null||a===void 0?void 0:a.call(s)})),e._pageFilesAll.filter(s=>s.fileType===".page.route"&&s.isDefaultPageFile).forEach(({filePath:s,fileExports:a})=>{if(l(a),"onBeforeRoute"in a){u(d(a,"onBeforeRoute","function"),`\`export { onBeforeRoute }\` of ${s} should be a function.`);const{onBeforeRoute:c}=a;t={filePath:s,onBeforeRoute:c}}"filesystemRoutingRoot"in a&&(u(d(a,"filesystemRoutingRoot","string"),`\`export { filesystemRoutingRoot }\` of ${s} should be a string.`),u(d(a,"filesystemRoutingRoot","string"),`\`export { filesystemRoutingRoot }\` of ${s} is \`'${a.filesystemRoutingRoot}'\` but it should start with a leading slash \`/\`.`),n.push({filesystemRoot:mt(s),routeRoot:a.filesystemRoutingRoot}))});const i=e._allPageIds,r=[];return i.filter(s=>!$e(s)).filter(s=>{const a=ht(s,e._pageFilesAll);if(!a)return!0;const{filePath:c,fileExports:f}=a;l(f),u("default"in f,`${c} should have a default export.`),u(d(f,"default","string")||d(f,"default","function"),`The default export of ${c} should be a string or a function.`),u(!("iKnowThePerformanceRisksOfAsyncRouteFunctions"in f)||d(f,"iKnowThePerformanceRisksOfAsyncRouteFunctions","boolean"),`The export \`iKnowThePerformanceRisksOfAsyncRouteFunctions\` of ${c} should be a boolean.`);const v=f.default;return r.push({pageId:s,filesystemRoute:null,pageRouteFile:{filePath:c,fileExports:f,routeValue:v}}),!1}).forEach(s=>{const a=ct(s,n);l(a.startsWith("/")),l(!a.endsWith("/")||a==="/"),r.push({pageId:s,filesystemRoute:a,pageRouteFile:null})}),{pageRoutes:r,onBeforeRouteHook:t}}function ht(e,t){return t.find(n=>n.pageId===e&&n.fileType===".page.route")}function mt(e){l(e.startsWith("/")),l(!e.endsWith("/"));const t=e.split("/"),n=x(t,0,-1).join("/")||"/";return l(n.startsWith("/")),l(!n.endsWith("/")||n==="/"),n}var T;function te(...e){var t,n;T||(T=(n=(t=globalThis).__brillout_debug_createDebugger)===null||n===void 0?void 0:n.call(t,"vps:routing")),T&&T(...e)}async function he(e){D(e);const{pageRoutes:t,onBeforeRouteHook:n}=await pt(e);te("Pages routes:",t.map(h=>({pageId:h.pageId,filesystemRoute:h.filesystemRoute,pageRouteFile:h.pageRouteFile&&{filePath:h.pageRouteFile.filePath,routeValue:h.pageRouteFile.routeValue}})));const i={};if(n){const h=await gt(n,e);if("hookError"in h)return h;if("pageContextProvidedByUser"in h){if(p(i,h.pageContextProvidedByUser),d(i,"_pageId","string")||d(i,"_pageId","null"))return d(i,"routeParams")?l(d(i,"routeParams","object")):p(i,{routeParams:{}}),p(i,{_routingProvidedByOnBeforeRouteHook:!0,_routeMatches:"CUSTOM_ROUTE"}),{pageContextAddendum:i};p(e,i)}}p(i,{_routingProvidedByOnBeforeRouteHook:!1});const r=e._allPageIds;l(r.length>=0),u(r.length>0,"No `*.page.js` file found. You must create a `*.page.js` file, e.g. `pages/index.page.js` (or `pages/index.page.{jsx, tsx, vue, ...}`).");const{urlPathname:o}=e;l(o.startsWith("/"));const s=[],a=[];if(await Promise.all(t.map(async h=>{const{pageId:g,filesystemRoute:E,pageRouteFile:O}=h;if(O){const _=O.fileExports,w=O.filePath;if(d(_,"default","string")){const m=_.default;u(m.startsWith("/"),`A Route String should start with a leading \`/\` but \`${w}\` has \`export default '${m}'\`. Make sure to \`export default '/${m}'\` instead.`);const A=K(m,o);if(A){const{routeParams:j}=A;a.push({pageId:g,routeString:m,routeParams:j,routeType:"STRING"})}}else if(d(_,"default","function")){const m=await dt(_,o,e,w);if(m&&"hookError"in m){s.push(m);return}if(m){const{routeParams:A,precedence:j}=m;a.push({pageId:g,precedence:j,routeParams:A,routeType:"FUNCTION"})}}else l(!1)}else{const _=at(E,o);if(_){const{routeParams:w}=_;a.push({pageId:g,routeParams:w,routeType:"FILESYSTEM"})}}})),s.length>0)return s[0];ot(a);const c=a[0];if(te(`Route matches for URL \`${o}\` (in precedence order):`,a),p(i,{_routeMatches:a}),!c)return p(i,{_pageId:null,routeParams:{}}),{pageContextAddendum:i};const{pageId:f,routeParams:v}=c;return l(P(v)),p(i,{_pageId:f,routeParams:v}),{pageContextAddendum:i}}const G={},me={},_t={},$={},_e={},yt=!0,vt={"/pages/_default/_error.page.vue":()=>y(()=>import("./pages/_default/_error.page-e34a9108.js"),["assets/pages/_default/_error.page-e34a9108.js","assets/chunk-7c63d4c9.js","assets/_error.page.847497e9.css"]),"/pages/help.page.vue":()=>y(()=>import("./pages/help.page-35ff4b57.js"),["assets/pages/help.page-35ff4b57.js","assets/chunk-2657c4e9.js","assets/chunk-7c63d4c9.js","assets/InlineCode.5702ee7c.css","assets/chunk-9687b1fa.js","assets/help.page.f79f29aa.css"]),"/pages/index.page.vue":()=>y(()=>import("./pages/index.page-e62d1780.js"),["assets/pages/index.page-e62d1780.js","assets/chunk-2657c4e9.js","assets/chunk-7c63d4c9.js","assets/InlineCode.5702ee7c.css"]),"/pages/spa.page.ts":()=>y(()=>import("./pages/spa.page-0eae1e0a.js"),[]),"/pages/ssg.page.vue":()=>y(()=>import("./pages/ssg.page-a8a48b1b.js"),["assets/pages/ssg.page-a8a48b1b.js","assets/chunk-2657c4e9.js","assets/chunk-7c63d4c9.js","assets/InlineCode.5702ee7c.css"]),"/pages/ssr.page.vue":()=>y(()=>import("./pages/ssr.page-25da81e1.js"),["assets/pages/ssr.page-25da81e1.js","assets/chunk-2657c4e9.js","assets/chunk-7c63d4c9.js","assets/InlineCode.5702ee7c.css"])},Pt={...vt};G[".page"]=Pt;const bt={},Rt={...bt};me[".page.route"]=Rt;const wt={"/pages/_default/_default.page.client.ts":()=>y(()=>import("./pages/_default/_default.page.client-1e3ddd80.js"),["assets/pages/_default/_default.page.client-1e3ddd80.js","assets/chunk-9687b1fa.js","assets/chunk-7c63d4c9.js","assets/base.360263fa.css"]),"/pages/spa.page.client.vue":()=>y(()=>import("./pages/spa.page.client-80e5a430.js"),["assets/pages/spa.page.client-80e5a430.js","assets/chunk-2657c4e9.js","assets/chunk-7c63d4c9.js","assets/InlineCode.5702ee7c.css"])},St={...wt};G[".page.client"]=St;const xt={"/pages/_default/_default.page.client.ts":je,"/pages/spa.page.client.vue":Le},Ot={...xt};$[".page.client"]=Ot;const Ft={"/pages/_default/_default.page.server.ts":Ne,"/pages/html.page.server.vue":He},Et={...Ft};$[".page.server"]=Et;const At={"/pages/_default/_error.page.vue":Ue,"/pages/help.page.vue":Be,"/pages/index.page.vue":Ve,"/pages/spa.page.ts":De,"/pages/ssg.page.vue":ze,"/pages/ssr.page.vue":Ke},Tt={...At};$[".page"]=Tt;const Ct={"/pages/_default/_default.page.server.ts":()=>y(()=>import("./chunk-4242da55.js"),["assets/chunk-4242da55.js","assets/_default.page.server.8147b987.css","assets/base.360263fa.css"]),"/pages/html.page.server.vue":()=>y(()=>import("./chunk-1f46a2fe.js"),["assets/chunk-1f46a2fe.js","assets/InlineCode.5702ee7c.css"])},It={...Ct};_e[".page.server"]=It;const kt=Object.freeze(Object.defineProperty({__proto__:null,isGeneratedFile:yt,neverLoaded:_e,pageFilesEager:me,pageFilesExportNamesEager:$,pageFilesExportNamesLazy:_t,pageFilesLazy:G},Symbol.toStringTag,{value:"Module"}));Ge(kt);function ye(){const e="/";return Wt(e)?"/":e}function Wt(e){return!!e.startsWith("http")}function ve(e){return!e.startsWith("/")&&!e.startsWith(".")&&!e.startsWith("?")&&e!==""}function $t(e,t){let n=!1;return()=>{n||(n=!0,setTimeout(()=>{n=!1,e()},t))}}function jt(e){return W(e,"/").pathname}function Y(e){window.location.href=e}const Lt="/";function Nt(e,t,n){l(t!==".pageContext.json"||n===!0);const{pathnameOriginal:i,searchOriginal:r,hashOriginal:o}=W(e,Lt);e.startsWith("/")&&l(e===`${i}${r||""}${o||""}`,{url:e});let s=i;if(n)s.endsWith("/")&&(s=x(s,0,-1)),l(!s.endsWith("/")),s===""&&(s="/index");else{const c=i.endsWith("/")?"":"/";s=s+`${c}index`}return`${s}${t}${r||""}${o||""}`}function Ht(){return!!Ut()}function Ut(){return!!window.__REACT_DEVTOOLS_GLOBAL_HOOK__}const Bt=R();let ne=!1;const Pe={markNavigationChange(){ne=!0},get noNavigationChangeYet(){return!ne&&this.isOriginalUrl(R())},isOriginalUrl(e){return e===Bt}};function be(e,t){return Ye(e,t)}async function Vt(e,t){const i=be(e,t).filter(o=>o.fileType===".page.server");return await Promise.all(i.map(async o=>{o.exportNames||(l(o.loadExportNames,t),await o.loadExportNames())})),{hasOnBeforeRenderServerSideOnlyHook:i.some(({exportNames:o})=>(l(o),o.includes("onBeforeRender")))}}function Dt(e,t,n,i){l(!t.endsWith(")"));const r=`The \`export { ${t} }\` of ${i}`;u(e==null||P(e),`${r} should return \`null\`, \`undefined\`, or a plain JavaScript object.`),e!=null&&(zt(e,n,r),"pageContext"in e&&pe(e.pageContext,{hook:{hookName:t,hookFilePath:i}}))}function zt(e,t,n){const i=[],r=Object.keys(e);for(const o of r)t.includes(o)||i.push(o);u(i.length===0,[n,"returned an object with unknown keys",M(i)+".","Only following keys are allowed:",M(t)+"."].join(" "))}async function Kt(e){return e._isFirstRenderAttempt&&Pe.isOriginalUrl(e.url)?Gt(e):Yt(e)}async function Gt(e){const t=Je();Re(t),p(t,{isHydration:!0,_comesDirectlyFromServer:!0});{const n=await V(e._pageFilesAll,t._pageId);if("errorFetchingStaticAssets"in n)throw J(),n.err;const{exports:i,exportsAll:r,pageExports:o,pageFilesLoaded:s}=n.pageContextAddendum;p(t,{exports:i,exportsAll:r,pageExports:o,_pageFilesLoaded:s})}return{pageContextAddendum:t}}async function Yt(e){const t={isHydration:!1};p(t,await qt(e));{const n=await V(e._pageFilesAll,t._pageId);if("errorFetchingStaticAssets"in n)return J(),Y(e.url),{errorFetchingStaticAssets:!0};const{exports:i,exportsAll:r,pageExports:o,pageFilesLoaded:s}=n.pageContextAddendum;p(t,{exports:i,exportsAll:r,pageExports:o,_pageFilesLoaded:s})}return p(t,await Jt({...e,...t})),l([!0,!1].includes(t._comesDirectlyFromServer)),{pageContextAddendum:t}}async function Jt(e){const t=qe(e,"onBeforeRender");if(t){const i=t.hook,r={_comesDirectlyFromServer:!1,_pageContextRetrievedFromServer:null},o=le({...e,...r}),s=await i(o);Dt(s,"onBeforeRender",["pageContext"],t.filePath);const a=s==null?void 0:s.pageContext;return p(r,a),r}else if((await Vt(e._pageFilesAll,e._pageId)).hasOnBeforeRenderServerSideOnlyHook){const i=await Qt(e),r={};return Object.assign(r,i),p(r,{_comesDirectlyFromServer:!0,_pageContextRetrievedFromServer:i}),r}return{_comesDirectlyFromServer:!1,_pageContextRetrievedFromServer:null}}async function qt(e){const t=await he(e);if("hookError"in t)throw t.hookError;const n=t.pageContextAddendum;return n._pageId===null?(setTimeout(()=>{Mt(e)},0),u(!1,`[404] Page ${e.url} does not exist. (\`vite-plugin-ssr\` will now server-side route to \`${e.url}\`.)`)):l(d(n,"_pageId","string")),n}function Mt(e){window.location.pathname=e.url}async function Qt(e){const t=Nt(e.url,".pageContext.json",!0),n=await fetch(t);l(n.status!==404);{const s=n.headers.get("content-type");u(s&&s.includes("application/json"),`Wrong HTTP Response Header \`content-type\` value for URL ${t} (it should be \`application/json\` but we got \`${s}\`). Make sure to use \`pageContext.httpResponse.contentType\`, see https://github.com/brillout/vite-plugin-ssr/issues/191`)}const i=await n.text(),r=Me(i);if(l(!("pageContext404PageDoesNotExist"in r)),"serverSideError"in r)throw Qe("`pageContext` could not be fetched from the server as an error occurred on the server; check your server logs.");l(d(r,"pageContext"));const o=r.pageContext;return l(P(o)),l(d(o,"_pageId","string")),Re(o),o}const re=["urlPathname","urlParsed"],Xt=["Page","pageExports","exports"];function Re(e){[...Xt,...re].forEach(n=>{n in e&&(re.includes(n)?(l(n.startsWith("url")),b(!1,`\`pageContext.${n}\` is already available in the browser when using \`useClientRouter()\`; including \`${n}\` in \`passToClient\` has no effect.`,{onlyOnce:!0})):b(!1,`\`pageContext.${n}\` is a built-in that cannot be overriden; including \`${n}\` in \`passToClient\` has no effect.`,{onlyOnce:!0}),delete e[n])})}let L;async function we(){return L||(L=await Zt()),L}async function Zt(){const e=ye();ue(e);const t={_urlProcessor:null,_baseUrl:e,_objectCreatedByVitePluginSsr:!0,_isProduction:!0},{pageFilesAll:n,allPageIds:i}=await Xe(!0);return p(t,{_pageFilesAll:n,_allPageIds:i}),t}async function Se(e){const t=await we(),n={url:e,...t},i=t._pageFilesAll;D(n);const r=await he(n);if(!("pageContextAddendum"in r))return{pageId:null,pageFilesAll:i};const o=r.pageContextAddendum._pageId;return o?{pageId:o,pageFilesAll:i}:{pageId:null,pageFilesAll:i}}function k(e){return e.exportNames?e.exportNames:(l(e.fileExports,e.pageId),Object.keys(e.fileExports))}function en({pageFilesClientSide:e,pageFilesServerSide:t,pageId:n}){return{isHtmlOnly:i(),isClientRouting:o()};function i(){return t.some(c=>c.pageId===n&&c.fileType===".page")?(r(),!1):t.some(c=>c.pageId===n&&c.fileType===".page.server")}function r(){const s=e.some(a=>k(a).includes("render"));u(s,["No client-side `render()` hook found.","See https://vite-plugin-ssr.com/render-modes for more information.",["Loaded client-side page files (none of them `export { render }`):",...e.map((a,c)=>` (${c+1}): ${a.filePath}`)].join(`
`)].join(" "))}function o(){return e.some(a=>k(a).includes("clientRouting"))}}function tn({pageFilesClientSide:e,pageFilesServerSide:t,isHtmlOnly:n,isClientRouting:i}){let r=[];const o=t.filter(a=>!e.includes(a)),s=[];if(s.push(...e.map(a=>({id:a.filePath,onlyAssets:!1}))),s.push(...o.map(a=>({id:a.filePath,onlyAssets:!0}))),n)r=e.map(a=>a.filePath);else{const a=i?"@@vite-plugin-ssr/dist/esm/client/router/entry.js":"@@vite-plugin-ssr/dist/esm/client/entry.js";s.push({id:a,onlyAssets:!1}),r=[a]}return{clientEntries:r,clientDependencies:s}}function nn(e,t){let n=ce(e,t);const i=be(e,t),{isHtmlOnly:r,isClientRouting:o}=en({pageFilesClientSide:n,pageFilesServerSide:i,pageId:t});r&&(n=n.filter(c=>c.fileType===".page.client"&&!k(c).includes("render")),n=sn(n));const{clientEntries:s,clientDependencies:a}=tn({pageFilesClientSide:n,pageFilesServerSide:i,isHtmlOnly:r,isClientRouting:o});return{isHtmlOnly:r,isClientRouting:o,clientEntries:s,clientDependencies:a,pageFilesClientSide:n,pageFilesServerSide:i}}async function rn(e,t,{sharedPageFilesAlreadyLoaded:n}){const i=ce(e,t);await Promise.all(i.map(async r=>{var o;l(r.fileType===".page"||r.fileType===".page.client"),!(n&&r.fileType===".page")&&await((o=r.loadExportNames)===null||o===void 0?void 0:o.call(r))}))}function sn(e){const t=[];for(const n of e)if(t.push(n),k(n).includes("overrideDefaultPages"))break;return t}async function xe(e){const{pageId:t,pageFilesAll:n}=await Se(e);if(!t)return!1;await rn(n,t,{sharedPageFilesAlreadyLoaded:!1});const{isHtmlOnly:i,isClientRouting:r}=nn(n,t);return!i&&r}function Oe(e){const t=e.getAttribute("href");return!!(t===null||t===""||ve(t)||on(e)||an(t)||!ln(t)||!Ze(t))}function on(e){const t=e.getAttribute("target"),n=e.getAttribute("rel");return t==="_blank"||t==="_external"||n==="external"||e.hasAttribute("download")}function an(e){if(e.startsWith("#"))return!0;const t=n=>n.split("#")[0];return!!(e.includes("#")&&t(e)===t(window.location.href))}function ln(e){const t=ye();ue(t);const{hasBaseUrl:n}=W(e,t);return n}function un(e,t){return{prefetchPageContext:!1,prefetchStaticAssets:cn(e,t)}}function cn(e,t){let n=fn(t),i=(()=>{if(n!==null)return n===!0?{when:"VIEWPORT"}:{when:"HOVER"};if("prefetchLinks"in e.exports&&u(n===null,"`export { prefetchLinks }` is deprecated, use `export { prefetchStaticAssets }` instead."),"prefetchStaticAssets"in e.exports){const{prefetchStaticAssets:r}=e.exports;if(r===!1)return!1;const o="`prefetchStaticAssets` should be either `false`, `{ when: 'VIEWPORT' }`, or `{ when: 'HOVER' }`";u(P(r),o);const s=Object.keys(r);u(s.length===1&&s[0]==="when",o);const{when:a}=r;if(a==="HOVER"||a==="VIEWPORT")return{when:a};u(!1,o)}return{when:"HOVER"}})();return i&&i.when==="VIEWPORT"&&!e._isProduction&&(fe(!1,"Viewport prefetching is disabled in development, see https://vite-plugin-ssr.com/clientRouting",{onlyOnce:!0}),i={when:"HOVER"}),i}function fn(e){let t=e.getAttribute("data-prefetch");if(b(t===null,"The `data-prefetch` attribute is outdated.",{onlyOnce:!0}),t===null)return null;if(l(typeof t=="string"),t==="true")return!0;if(t==="false")return!1;u(!1,`Wrong data-prefetch value: \`"${t}"\`; it should be \`"true"\` or \`"false"\`.`)}const Fe=new Map;function Ee(e){const t=Te(e);return Fe.has(t)}function Ae(e){const t=Te(e);Fe.set(t,!0)}function Te(e){return jt(e)}const se=new Map;async function N(e){if(u(!ve(e),`You are trying to prefetch ${e} which is an external URL. This doesn't make sense since vite-plugin-ssr cannot prefetch external links.`),Ee(e))return;Ae(e);const{pageId:t,pageFilesAll:n}=await Se(e);t&&"errorFetchingStaticAssets"in await V(n,t)&&J()}function dn(e){Ae(e.url),[...document.getElementsByTagName("A")].forEach(async n=>{if(se.has(n))return;se.set(n,!0);const i=n.getAttribute("href");if(Oe(n)||(l(i),!await xe(i))||Ee(i))return;const r=un(e,n);if(r.prefetchStaticAssets){if(r.prefetchStaticAssets.when==="HOVER")n.addEventListener("mouseover",()=>N(i)),n.addEventListener("touchstart",()=>N(i),{passive:!0});else if(r.prefetchStaticAssets.when==="VIEWPORT"){const o=new IntersectionObserver(s=>{s.forEach(a=>{a.isIntersecting&&(N(i),o.disconnect())})});o.observe(n)}}else return})}const gn="__vite_plugin_ssr__navigate";wn();let H,Ce=!1;function J(){Ce=!0,fe(!1,"New deployed frontend detected. The next page navigation will use Server Routing instead of Client Routing.",{onlyOnce:!0})}function pn(){bn(),hn((r,{keepScrollPosition:o})=>{i(o?"preserve-scroll":"scroll-to-top-or-hash",r)}),mn(r=>{i(r)}),globalThis[gn]=async(r,{keepScrollPosition:o,overwriteLastHistoryEntry:s})=>{await i(o?"preserve-scroll":"scroll-to-top-or-hash",r,s)};let e=0,t,n=!1;i("preserve-scroll");return;async function i(r,o=R(),s=!1){var a,c;if(Ce){Y(o);return}const f=++e;l(f>=1),f>1&&n===!1&&(H&&H(),n=!0);const v=()=>Ht()&&f===1?!1:f!==e,h=await we();if(v())return;const g={url:o,_isFirstRenderAttempt:f===1,...h};D(g);const E=await Kt(g);if("errorFetchingStaticAssets"in E)return;const{pageContextAddendum:O}=E;v()||(p(g,O),"onPageTransitionStart"in g.exports&&(u(d(g.exports,"onPageTransitionStart","function"),"The `export { onPageTransitionStart }` of "+g.exportsAll.onPageTransitionStart[0]._filePath+" should be a function."),H=g.exports.onPageTransitionStart),t&&await t,!v()&&(_n(o,s),Pe.markNavigationChange(),l(t===void 0),t=(async()=>{const _=le(g);et(g);const w=await g.exports.render(_);u(w===void 0,"`export { render }` of "+g.exportsAll.render[0]._filePath+" should not return any value"),dn(g)})(),await t,t=void 0,g._isFirstRenderAttempt?(tt(g,"onHydrationEnd"),await((c=(a=g.exports).onHydrationEnd)===null||c===void 0?void 0:c.call(a,g))):f===e&&(g.exports.onPageTransitionEnd&&(u(d(g.exports,"onPageTransitionEnd","function"),"The `export { onPageTransitionEnd }` of "+g.exportsAll.onPageTransitionEnd[0]._filePath+" should be a function."),g.exports.onPageTransitionEnd()),n=!1),vn(r),q(),Ie=!0))}}function hn(e){document.addEventListener("click",t);return;async function t(r){if(!n(r))return;const o=i(r.target);if(!o)return;const s=o.getAttribute("href");if(Oe(o))return;if(l(s),r.preventDefault(),!await xe(s)){Y(s);return}const a=![null,"false"].includes(o.getAttribute("keep-scroll-position"));e(s,{keepScrollPosition:a})}function n(r){return r.button===0&&!r.ctrlKey&&!r.shiftKey&&!r.altKey&&!r.metaKey}function i(r){for(;r.tagName!=="A";){const{parentNode:o}=r;if(!o)return null;r=o}return r}}let B=R({withoutHash:!0});function mn(e){window.addEventListener("popstate",t=>{const n=R({withoutHash:!0});if(n==B)return;B=n;const r=Pn(t.state)||"scroll-to-top-or-hash";e(r)})}function _n(e,t){R()!==e&&(q(),t?window.history.replaceState(void 0,"",e):window.history.pushState(void 0,"",e),B=R({withoutHash:!0}))}function yn(){return{x:window.scrollX,y:window.scrollY}}function vn(e){if(e==="preserve-scroll")return;let t;if(e==="scroll-to-top-or-hash"){const r=Rn();if(r&&r!=="top"){const o=document.getElementById(r)||document.getElementsByName(r)[0];if(o){o.scrollIntoView();return}}t={x:0,y:0}}else l("x"in e&&"y"in e),t=e;const{x:n,y:i}=t;window.scrollTo(n,i)}function Pn(e=window.history.state){return d(e,"scrollPosition")?e.scrollPosition:null}function bn(){window.addEventListener("scroll",$t(oe,Math.ceil(1e3/3)),{passive:!0}),ke(oe)}function oe(){const e=yn();window.history.replaceState({scrollPosition:e},"")}function Rn(){let{hash:e}=window.location;return e===""?null:(l(e.startsWith("#")),e=e.slice(1),e)}let Ie=!1;function wn(){ie(),ke(ie),Sn(()=>Ie&&q())}function q(){"scrollRestoration"in window.history&&(window.history.scrollRestoration="manual")}function ie(){"scrollRestoration"in window.history&&(window.history.scrollRestoration="auto")}function ke(e){window.addEventListener("visibilitychange",()=>{document.visibilityState==="hidden"&&e()})}function Sn(e){window.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&e()})}pn();
